define("bundles/ondemand/components/endOfCourse/components/HeaderSummary",["require","exports","module","react","react-router","classnames","js/lib/path","pages/open-course/common/models/course","bundles/ondemand/components/HonorsBanner","bundles/page/components/TrackedLink2","bundles/page/components/TrackedButton","bundles/enroll/components/EnrollModal","pages/open-course/common/models/tracks","bundles/ondemand/utils/url","vendor/cnpm/fluxible.v0-4/addons/connectToStores","bundles/ondemand/stores/StoreComputationHelpers","js/lib/coursera.react-intl","i18n!nls/ondemand","css!./__styles__/HeaderSummary"],function(require,exports,module){"use strict";function _defaults(e,n){for(var o=Object.getOwnPropertyNames(n),t=0;t<o.length;t++){var r=o[t],s=Object.getOwnPropertyDescriptor(n,r);s&&s.configurable&&void 0===e[r]&&Object.defineProperty(e,r,s)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var r,s,e=require("react"),o=require("react-router"),a=o.Link,i=require("classnames"),c=require("js/lib/path"),l=require("pages/open-course/common/models/course"),d=require("bundles/ondemand/components/HonorsBanner"),u=require("bundles/page/components/TrackedLink2"),n=u.TrackedA,p=require("bundles/page/components/TrackedButton"),m=require("bundles/enroll/components/EnrollModal"),h=require("pages/open-course/common/models/tracks"),f=h.HONORS_TRACK,g=require("bundles/ondemand/utils/url"),y=g.getAssignmentsUrl,b=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores"),P=require("bundles/ondemand/stores/StoreComputationHelpers"),v=P.hasPassedTrack,E=require("js/lib/coursera.react-intl"),k=E.FormattedHTMLMessage,t=require("i18n!nls/ondemand");require("css!./__styles__/HeaderSummary");var C=(s=r=function(r){function HeaderSummary(){var s,e,n;_classCallCheck(this,HeaderSummary);for(var o=arguments.length,a=Array(o),t=0;o>t;t++)a[t]=arguments[t];return s=e=_possibleConstructorReturn(this,r.call.apply(r,[this].concat(a))),e.state={showEnrollModal:!1},e.openEnrollModal=function(){e.setState({showEnrollModal:!0})},e.closeEnrollModal=function(){e.setState({showEnrollModal:!1})},n=s,_possibleConstructorReturn(e,n)}return _inherits(HeaderSummary,r),HeaderSummary.prototype.getFinalGrade=function getFinalGrade(){return this.props.finalGrade?this.props.finalGrade:"--"},HeaderSummary.prototype.getCertificatePurchaseUrl=function getCertificatePurchaseUrl(){var e=this.props.courseSlug;return c.join("/certificate",e)},HeaderSummary.prototype.renderCertificateMessage=function renderCertificateMessage(){var s=this.props.courseRootPath;if(this.props.certificateLink)return e.createElement("a",{href:this.props.certificateLink},t("Course Certificate"));if(this.props.currentlyOwnsCertificate){if(!this.props.hasPassedWithVerification&&this.props.hasPassedPendingVerification)return t("Some of your assignments are still being verified.\n        Please check back soon to receive your Course Certificate!");if(this.props.hasPassedWithVerification||this.props.hasPassedPendingVerification){var o=e.createElement("a",{href:"/accomplishments"},t("your accomplishments page"));return e.createElement(k,{message:t("You have passed this course! Check your email for a link to your certificate.\n                      If you don't receive your certificate within 24 hours, check {accomplishmentsPageLink} to make\n                      sure that your profile is complete."),accomplishmentsPageLink:o})}return e.createElement("div",null,e.createElement("div",null,t("To receive your certificate, you must resubmit\n            and pass unverified assignments with verification.")),e.createElement(a,{to:y(s)},t("View Assignments")))}var r="";return r=this.props.s12nId&&this.props.s12n&&this.props.s12n.get("launchedAt")?e.createElement(p,{onClick:this.openEnrollModal,className:"button-link",trackingName:"headerSummaryButton"},t("Unlock a certificate")):e.createElement(n,{href:this.getCertificatePurchaseUrl(),trackingName:"headerSummaryLink"},t("Unlock a certificate")),e.createElement("span",null,r,t(" to share your achievement with the world!"))},HeaderSummary.prototype.render=function render(){var r=this.props,n=r.course,o=r.courseId,a=r.currentlyOwnsCertificate,c=r.certificateLink,s=a||c||n.isCertificatePurchaseEnabled(),l=i("grade-section","horizontal-box","align-items-right",{"with-right-border":s});return e.createElement("div",{className:"rc-HeaderSummary"},e.createElement("div",{className:"header-summary-body horizontal-box"},this.props.hasFinalGrade&&e.createElement("div",{className:l},e.createElement("div",{className:"body-1-text final-grade-text"},t("Final Grade")),e.createElement("div",{className:"vertical-box align-items-vertical-center"},e.createElement("div",{className:"horizontal-box"},e.createElement("div",{className:"headline-6-text grade"},this.getFinalGrade()),e.createElement("div",{className:"headline-1-text percent-symbol"},"%")),this.props.hasPassedHonorsTrack&&e.createElement(d,{className:"honors-margin"}))),s&&e.createElement("div",{className:"flex-1 cert-section horizontal-box"},e.createElement("div",{className:"cert-ribbon"}),e.createElement("div",{className:"flex-1 cert-message"},this.renderCertificateMessage()))),this.state.showEnrollModal&&e.createElement(m,{s12nId:this.props.s12nId,courseIdOverride:o,showFreeOption:!1,onSdp:!1,onClose:this.closeEnrollModal}))},HeaderSummary}(e.Component),r.propTypes={courseId:e.PropTypes.string.isRequired,courseSlug:e.PropTypes.string.isRequired,courseRootPath:e.PropTypes.string.isRequired,course:e.PropTypes.instanceOf(l).isRequired,currentlyOwnsCertificate:e.PropTypes.bool.isRequired,hasPassedWithVerification:e.PropTypes.bool.isRequired,hasPassedPendingVerification:e.PropTypes.bool.isRequired,hasFinalGrade:e.PropTypes.bool,finalGrade:e.PropTypes.string,hasPassedHonorsTrack:e.PropTypes.bool,certificateLink:e.PropTypes.string,s12nId:e.PropTypes.string,s12n:e.PropTypes.object},s);module.exports=b(C,["CourseViewGradeStore","VerificationStore","CourseStore","CertificateStore","S12nStore"],function(t,i){var e=t.CourseViewGradeStore,n=t.VerificationStore,r=t.CourseStore,a=t.CertificateStore,s=t.S12nStore,o=n.getVerificationDisplay();return{courseId:r.getCourseId(),course:r.getMetadata(),courseRootPath:r.getCourseRootPath(),hasFinalGrade:e.isPassable(),finalGrade:e.getFinalPercentCourseGrade(),currentlyOwnsCertificate:n.currentlyOwnsCertificate(),hasPassedWithVerification:e.hasPassedCourseWithVerification(),hasPassedPendingVerification:e.hasPendingItem(o)&&e.allVerifiedPassedOrPending(o),hasPassedHonorsTrack:v(e,n,f),certificateLink:a.getCertificateLink({courseId:r.getCourseId()}),s12nId:s.getS12n()?s.getS12n().s12n.get("id"):null,s12n:s.getS12n()?s.getS12n().s12n:null}})});