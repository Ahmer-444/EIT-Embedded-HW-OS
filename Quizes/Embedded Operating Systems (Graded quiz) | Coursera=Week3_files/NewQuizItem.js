define("bundles/ondemand/components/quiz/NewQuizItem",["require","exports","module","classnames","react","bundles/assess/assessmentTypes/phoenixQuiz/assessment","bundles/content-feedback/constants/ItemTypes","bundles/ondemand/components/ItemLayout","bundles/ondemand/components/item/LightItemLayout","bundles/ondemand/utils/itemViewValidator","bundles/phoenix/components/OrigamiRegion","bundles/quiz-common/actions/QuizActions","bundles/quiz/components/TrackedQuiz","bundles/quiz-common/constants/QuizStates","bundles/quiz-common/models/GradingAttempt","pages/open-course/common/models/itemMetadata","pages/open-course/common/utils/lockExperiment","pages/open-course/verification/views/verification","bundles/phoenix/lib/waitForStores"],function(require,exports,module){"use strict";function _defaults(e,s){for(var i=Object.getOwnPropertyNames(s),t=0;t<i.length;t++){var n=i[t],o=Object.getOwnPropertyDescriptor(s,n);o&&o.configurable&&void 0===e[n]&&Object.defineProperty(e,n,o)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=Object.assign||function(o){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])}return o},t,s,c,i,u,b=require("classnames"),e=require("react"),w=require("bundles/assess/assessmentTypes/phoenixQuiz/assessment"),v=require("bundles/content-feedback/constants/ItemTypes"),P=require("bundles/ondemand/components/ItemLayout"),C=require("bundles/ondemand/components/item/LightItemLayout"),I=require("bundles/ondemand/utils/itemViewValidator"),f=require("bundles/phoenix/components/OrigamiRegion"),o=require("bundles/quiz-common/actions/QuizActions"),l=o.loadQuiz,g=o.showQuizStart,y=o.verifyQuiz,h=o.attemptQuiz,T=require("bundles/quiz/components/TrackedQuiz"),r=require("bundles/quiz-common/constants/QuizStates"),z=require("bundles/quiz-common/models/GradingAttempt"),d=require("pages/open-course/common/models/itemMetadata"),S=require("pages/open-course/common/utils/lockExperiment"),q=require("pages/open-course/verification/views/verification"),x=require("bundles/phoenix/lib/waitForStores"),m=r.START,a=r.VERIFY,n=r.ATTEMPT,O=(t={},_defineProperty(t,m,w),_defineProperty(t,a,q),_defineProperty(t,n,T),t),M=[a,n],R=[n],j=(c=s=function(t){function QuizItem(){var s,e,i;_classCallCheck(this,QuizItem);for(var r=arguments.length,u=Array(r),o=0;r>o;o++)u[o]=arguments[o];return s=e=_possibleConstructorReturn(this,t.call.apply(t,[this].concat(u))),e.state={stateOptions:{}},e.handleStateChange=function(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e.context.executeAction;switch(o){case m:t(g);break;case a:t(y);break;case n:t(h,s);break;default:throw new Error("Unknown quiz state: "+o)}},i=s,_possibleConstructorReturn(e,i)}return _inherits(QuizItem,t),QuizItem.prototype.componentDidMount=function componentDidMount(){var e=this.props,t=e.courseId,n=e.courseMaterials,o=e.courseGrade,s=e.courseProgress;S.setup(t,n,o,s)},QuizItem.prototype.renderView=function renderView(){var o=this.props,t=o.quizState,r=o.contentModel,s=this.state.stateOptions,n=O[t],i=R.includes(t);if(!n)throw new Error("Unknown state: "+t);return e.createElement("div",{className:b("rc-QuizItem",{state:t})},i&&e.createElement(n,p({},this.props,s,{onStateChange:this.handleStateChange})),!i&&e.createElement(f,{ViewClass:n,viewOptions:p({},this.props,s,{model:r,fluxibleContext:this.context.fluxibleContext,onStateChange:this.handleStateChange})}))},QuizItem.prototype.render=function render(){var t=this.props,o=t.itemMetadata,s=t.quizState,i=M.includes(s),n=this.renderView();if(i)return n;return e.createElement(P,null,e.createElement(C,{isCard:!0,itemType:v.Quiz,itemMetadata:o},n))},QuizItem}(e.Component),s.propTypes={itemMetadata:e.PropTypes.instanceOf(d).isRequired,quizState:e.PropTypes.string.isRequired,attemptState:e.PropTypes.string.isRequired,gradingAttempt:e.PropTypes.instanceOf(z),sessionId:e.PropTypes.string,sessionData:e.PropTypes.object,attemptIndex:e.PropTypes.number,verifiableId:e.PropTypes.string,courseId:e.PropTypes.string.isRequired,courseMaterials:e.PropTypes.object.isRequired,courseGrade:e.PropTypes.object.isRequired,courseProgress:e.PropTypes.object.isRequired,verificationDisplay:e.PropTypes.object.isRequired,contentModel:e.PropTypes.object.isRequired,assessmentClient:e.PropTypes.object.isRequired},s.contextTypes={executeAction:e.PropTypes.func.isRequired,fluxibleContext:e.PropTypes.object.isRequired},c),Q=x(["QuizStore","CourseStore","CourseViewGradeStore","VerificationStore"],function(t,i){var e=t.QuizStore,n=t.CourseStore,o=t.CourseViewGradeStore,s=t.VerificationStore;return{quizState:e.getQuizState(),attemptState:e.getAttemptState(),gradingAttempt:e.getGradingAttempt(),sessionId:e.getSessionId(),sessionData:e.getSessionData(),attemptIndex:e.getAttemptIndex(),verifiableId:e.getVerifiableId(),courseId:n.getCourseId(),courseMaterials:n.getMaterials(),courseGrade:o.getCourseViewGrade(),verificationDisplay:s.getVerificationDisplay(),assessmentClient:e.getAssessmentClient(),contentModel:e.getContentModel()}})(j),A=(u=i=function(t){function QuizItemContainer(){return _classCallCheck(this,QuizItemContainer),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(QuizItemContainer,t),QuizItemContainer.prototype.componentDidMount=function componentDidMount(){var e=this.props.itemMetadata;this.context.executeAction(l,{itemMetadata:e})},QuizItemContainer.prototype.render=function render(){return e.createElement(Q,this.props)},QuizItemContainer}(e.Component),i.propTypes={itemMetadata:e.PropTypes.instanceOf(d).isRequired},i.contextTypes={executeAction:e.PropTypes.func.isRequired},u);module.exports=I(A,{renderItemLayout:!0})});