define("nls/page",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pseudo:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("nls/phoenix",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pseudo:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("nls/ondemand",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pseudo:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("nls/naptimejs",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("bundles/requirejs/identity",["require","exports","module"],function(require,exports,module){module.exports=function(){for(var r=arguments.length,t=Array(r),e=0;r>e;e++)t[e]=arguments[e];return t}});
define("js/lib/require.memoize",["module"],function(module){function argsToJsonHasher(){var r=Array.prototype.slice.call(arguments);return JSON.stringify(r)}function memoize(e,t){var n={};t=t||argsToJsonHasher;var r=function memoized(){var r=t.apply(this,arguments);return r in n||(n[r]=e.apply(this,arguments)),n[r]};return r.force=function(){return r.clear.apply(this,arguments),r.apply(this,arguments)},r.clear=function(){var r=t.apply(this,arguments);delete n[r]},r.reset=function(){n={}},r}var r={version:"0.0.1",load:function load(r,n,t,e){n([r],function(r){t(memoize(r))})}};return r});

define("bundles/requirejs/plugins/lazy",["require","exports","module"],function(require,exports,module){var e={version:"0.0.1",load:function load(e,r,u,i){var n=function getModule(n){r([e],function(e){return n(e)})};return n.lazy={moduleId:e},u(n)}};module.exports=e});

define("nls/scribe-plugins",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("nls/ui",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pseudo:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("nls/author-code-evaluator",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("nls/code-evaluator",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("nls/asset-admin",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pseudo:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});

define('css!bundles/scribe-plugins/styles/scribe-image-upload-command',[],function(){})
define("nls/cml",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("nls/content-feedback",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pseudo:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});






define("nls/profile",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pseudo:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});



define("nls/discussions",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pseudo:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});

define('css!bundles/phoenix/components/__styles__/ProfileImage',[],function(){})
define("nls/classmates",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pseudo:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});

define('css!bundles/classmates/components/__styles__/MiniProfile',[],function(){})

define('css!bundles/discussions/components/__styles__/ModerationReasons',[],function(){})
define("js/lib/getPropsFromPromise",["require","exports","module","underscore","react","js/lib/hoistNonReactStatics"],function(require,exports,module){function _defaults(t,n){for(var i=Object.getOwnPropertyNames(n),e=0;e<i.length;e++){var o=i[e],r=Object.getOwnPropertyDescriptor(n,o);r&&r.configurable&&void 0===t[o]&&Object.defineProperty(t,o,r)}return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):_defaults(e,t))}var _=require("underscore"),t=require("react"),e=require("js/lib/hoistNonReactStatics");module.exports=function(o){return function(r){var n,i,c=r.displayName||r.name,s=(i=n=function(e){function GetPropsFromPromiseWrapper(){return _classCallCheck(this,GetPropsFromPromiseWrapper),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(GetPropsFromPromiseWrapper,e),GetPropsFromPromiseWrapper.prototype.componentDidMount=function componentDidMount(){this.update(this.props)},GetPropsFromPromiseWrapper.prototype.componentWillReceiveProps=function componentWillReceiveProps(t){var e,o=this,r=(e=_([].concat(Object.keys(t),Object.keys(this.props))).chain().uniq()).without.apply(e,["children","history","location","params","route","routeParams","routes"]).some(function(e){return!_.isEqual(o.props[e],t[e])}).value();r&&this.update(t)},GetPropsFromPromiseWrapper.prototype.update=function update(e){var r=this,t=o(e).then(function(t){r.setState(t)});t["catch"]&&t["catch"](function(t){throw t}),t.done&&t.done()},GetPropsFromPromiseWrapper.prototype.render=function render(){return t.createElement(r,Object.assign({},this.props,this.state))},GetPropsFromPromiseWrapper}(t.Component),n.displayName=c+"GetPropsFromPromiseWrapper",i);return e(s,r),s}}});

define('css!bundles/profile/components/__styles__/ImageEditorButton',[],function(){})
define("bundles/profile/components/ImageEditorButton",["require","exports","module","react","bundles/iconfont/Icon","react-bootstrap","bundles/phoenix/template/models/userIdentity","classnames","i18n!nls/discussions","css!bundles/profile/components/__styles__/ImageEditorButton.css"],function(require,exports,module){function _defaults(e,r){for(var s=Object.getOwnPropertyNames(r),t=0;t<s.length;t++){var n=s[t],o=Object.getOwnPropertyDescriptor(r,n);o&&o.configurable&&void 0===e[n]&&Object.defineProperty(e,n,o)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var t,n,e=require("react"),s=require("bundles/iconfont/Icon"),o=require("react-bootstrap"),i=o.OverlayTrigger,c=o.Tooltip,p=require("bundles/phoenix/template/models/userIdentity"),r=require("classnames"),a=require("i18n!nls/discussions");require("css!bundles/profile/components/__styles__/ImageEditorButton.css");var l=(n=t=function(t){function ImageEditorButton(){var o,e,r;_classCallCheck(this,ImageEditorButton);for(var s=arguments.length,i=Array(s),n=0;s>n;n++)i[n]=arguments[n];return o=e=_possibleConstructorReturn(this,t.call.apply(t,[this].concat(i))),e.openFileUploader=function(){e.props.onButtonClick()},r=o,_possibleConstructorReturn(e,r)}return _inherits(ImageEditorButton,t),ImageEditorButton.prototype.render=function render(){var t=r("rc-ImageEditorButton",{mini:this.props.mini}),n=r("color-primary-text",{"cif-2x":!this.props.mini,"cif-fw":this.props.mini}),o=e.createElement(c,null,e.createElement("span",null,a("Upload photo")));return e.createElement("section",{className:t},e.createElement(i,{placement:"right",overlay:o},e.createElement("button",{className:"passive camera theme-light",onClick:this.openFileUploader},e.createElement(s,{name:"camera",className:n}))))},ImageEditorButton}(e.Component),t.propTypes={onButtonClick:e.PropTypes.func.isRequired,isMini:e.PropTypes.bool},n);module.exports=l});
define("bundles/confirmNavigation/nls/confirmNavigation",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pseudo:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("js/lib/nls/moment.lang",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pt:!0,ru:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("bundles/profile/components/ReactAvatarEditor",["require","exports","module","react","react-dom"],function(require,exports,module){function _defaults(e,r){for(var n=Object.getOwnPropertyNames(r),t=0;t<n.length;t++){var o=n[t],i=Object.getOwnPropertyDescriptor(r,o);i&&i.configurable&&void 0===e[o]&&Object.defineProperty(e,o,i)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var o,r,e=require("react"),n=require("react-dom"),i="ontouchstart"in window||navigator.msMaxTouchPoints>0,a={mobile:{react:{down:"onTouchStart",drag:"onTouchMove",drop:"onTouchEnd",move:"onTouchMove",up:"onTouchUp"},"native":{down:"touchstart",drag:"touchmove",drop:"touchend",move:"touchmove",up:"touchup"}},desktop:{react:{down:"onMouseDown",drag:"onDragOver",drop:"onDrop",move:"onMouseMove",up:"onMouseUp"},"native":{down:"mousedown",drag:"dragStart",drop:"drop",move:"mousemove",up:"mouseup"}}},t=i?a.mobile:a.desktop,s=(r=o=function(o){function ReactAvatarEditor(){var r,e,n;_classCallCheck(this,ReactAvatarEditor);for(var a=arguments.length,s=Array(a),t=0;a>t;t++)s[t]=arguments[t];return r=e=_possibleConstructorReturn(this,o.call.apply(o,[this].concat(s))),e.state={drag:!1,my:null,mx:null,image:{x:0,y:0}},e.handleDragOver=function(e){e.preventDefault()},e.handleUploadReady=function(t){e.loadImage(t.target.result)},e.handleMouseMove=function(o){if(0==e.state.drag)return;var t=e.state.image,a=t.x,s=t.y,r=i?event.targetTouches[0].pageX:o.clientX,n=i?event.targetTouches[0].pageY:o.clientY,h={mx:r,my:n,image:t};if(e.state.mx&&e.state.my){var d=e.state.mx-r,p=e.state.my-n;t.y=e.getBoundedY(s-p,e.props.scale),t.x=e.getBoundedX(a-d,e.props.scale)}e.setState(h)},e.handleDrop=function(t){t.stopPropagation(),t.preventDefault();var o=new FileReader;o.onload=e.handleUploadReady,o.readAsDataURL(t.dataTransfer.files[0])},e.handleMouseUp=function(){e.state.drag&&e.setState({drag:!1})},e.handleMouseDown=function(){e.setState({drag:!0,mx:null,my:null})},e.handleImageReady=function(o){var t=e.getInitialSize(o.width,o.height);t.resource=o,t.x=e.props.border,t.y=e.props.border,e.setState({drag:!1,image:t},e.props.onImageReady)},n=r,_possibleConstructorReturn(e,n)}return _inherits(ReactAvatarEditor,o),ReactAvatarEditor.prototype.componentDidMount=function componentDidMount(){var e=n.findDOMNode(this).getContext("2d");this.props.image&&this.loadImage(this.props.image),this.paint(e),document&&document.addEventListener(t["native"].move,this.handleMouseMove,!1),document&&document.addEventListener(t["native"].up,this.handleMouseUp,!1)},ReactAvatarEditor.prototype.componentWillReceiveProps=function componentWillReceiveProps(e){this.props.image!=e.image&&this.loadImage(e.image),this.props.scale!=e.scale&&this.squeeze(e)},ReactAvatarEditor.prototype.componentDidUpdate=function componentDidUpdate(){var e=n.findDOMNode(this).getContext("2d");e.clearRect(0,0,this.getDimensions().canvas.width,this.getDimensions().canvas.height),this.paint(e),this.paintImage(e,this.state.image)},ReactAvatarEditor.prototype.componentWillUnmount=function componentWillUnmount(){document&&document.removeEventListener(t["native"].move,this.handleMouseMove,!1),document&&document.removeEventListener(t["native"].up,this.handleMouseUp,!1)},ReactAvatarEditor.prototype.getCropPositions=function getCropPositions(){var t=this.getDimensions(),e=this.state.image;return{x:-1*e.x+t.border,y:-1*e.y+t.border,width:e.width*this.props.scale,height:e.height*this.props.scale}},ReactAvatarEditor.prototype.getInitialSize=function getInitialSize(o,i){var e=void 0,t=void 0,r=void 0,n=void 0,a=void 0;return r=this.getDimensions(),n=r.height/r.width,a=i/o,n>a?(e=this.getDimensions().height,t=o*(e/i)):(t=this.getDimensions().width,e=i*(t/o)),{height:e,width:t}},ReactAvatarEditor.prototype.getImage=function getImage(r,n){var t=document.createElement("canvas"),i=t.getContext("2d"),o=this.getDimensions();t.width=o.width,t.height=o.height,i.globalCompositeOperation="destination-over";var e=this.state.image;return this.paintImage(i,{resource:e.resource,x:e.x-o.border,y:e.y-o.border,width:e.width,height:e.height}),t.toDataURL(r,n)},ReactAvatarEditor.prototype.getDimensions=function getDimensions(){return{width:this.props.width,height:this.props.height,border:this.props.border,canvas:{width:this.props.width+2*this.props.border,height:this.props.height+2*this.props.border}}},ReactAvatarEditor.prototype.getBoundedY=function getBoundedY(t,r){var i=this.state.image,e=this.getDimensions(),n=Math.ceil((i.height*r-i.height)/2),a=Math.ceil(-i.height*r+e.height+e.border),s=e.border,o=void 0;return t-n>=e.border&&(o=e.border+n),a>t&&(o=a),t>s&&(o=s),o||t},ReactAvatarEditor.prototype.getBoundedX=function getBoundedX(t,r){var i=this.state.image,e=this.getDimensions(),n=Math.ceil((i.width*r-i.width)/2),a=Math.ceil(-i.width*r+e.width+e.border),s=e.border,o=void 0;return t-n>=e.border&&(o=e.border+n),a>t&&(o=a),t>s&&(o=s),o||t},ReactAvatarEditor.prototype.isDataURL=function isDataURL(e){var t=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i;return!!e.match(t)},ReactAvatarEditor.prototype.paint=function paint(t){t.save(),t.translate(0,0),t.fillStyle="rgba("+this.props.color.slice(0,4).join(",")+")";var o=this.getDimensions(),e=o.border,i=o.canvas.height,r=o.canvas.width;t.fillRect(0,0,r,e),t.fillRect(0,i-e,r,e),t.fillRect(0,e,e,i-2*e),t.fillRect(r-e,e,e,i-2*e),t.restore()},ReactAvatarEditor.prototype.squeeze=function squeeze(t){var e=this.state.image;e.y=this.getBoundedY(e.y,t.scale),e.x=this.getBoundedX(e.x,t.scale),this.setState({image:e})},ReactAvatarEditor.prototype.calculatePosition=function calculatePosition(o){o=o||this.state.image;var e=void 0,t=void 0,n=void 0,r=void 0,i=this.getDimensions();n=o.width*this.props.scale,r=o.height*this.props.scale;var d=(n-o.width)/2,h=(r-o.height)/2;e=o.x-d,t=o.y-h,e=Math.min(e,i.border),t=Math.min(t,i.border);var s=r+(t-i.border);t=s>i.height?t:t+(i.height-s);var a=n+(e-i.border);return e=a>i.width?e:e+(i.width-a),{x:e,y:t,height:r,width:n}},ReactAvatarEditor.prototype.paintImage=function paintImage(t,e){if(e.resource){var o=this.calculatePosition(e);t.save(),t.globalCompositeOperation="destination-over",t.drawImage(e.resource,e.x,e.y,o.width,o.height),t.restore()}},ReactAvatarEditor.prototype.loadImage=function loadImage(t){var e=new Image;e.onload=this.handleImageReady.bind(this,e),this.isDataURL(t)||(e.crossOrigin="anonymous"),e.src=t},ReactAvatarEditor.prototype.render=function render(){var o={width:this.getDimensions().canvas.width,height:this.getDimensions().canvas.height,style:this.props.style};return o[t.react.down]=this.handleMouseDown,o[t.react.drag]=this.handleDragOver,o[t.react.drop]=this.handleDrop,e.createElement("canvas",o)},ReactAvatarEditor}(e.Component),o.propTypes={scale:e.PropTypes.number,image:e.PropTypes.string,border:e.PropTypes.number,width:e.PropTypes.number,height:e.PropTypes.number,color:e.PropTypes.arrayOf(e.PropTypes.number),onImageReady:e.PropTypes.func,style:e.PropTypes.object},o.defaultProps={scale:1,border:25,width:200,height:200,color:[0,0,0,.5],onImageReady:function onImageReady(){},style:{}},r);module.exports=s});
define("bundles/profile/common/api/profile",["require","exports","module","bundles/phoenix/lib/apiWrapper","bundles/profile/constants/constants"],function(require,exports,module){var e=require("bundles/phoenix/lib/apiWrapper"),n=require("bundles/profile/constants/constants");module.exports=e(n.profileApi,{type:"rest"})});
define("bundles/profile/actions/ProfileActions",["require","exports","module","q","bundles/phoenix/lib/apiWrapper","jsuri","bundles/profile/common/api/profile"],function(require,exports,module){var e=require("q"),r=require("bundles/phoenix/lib/apiWrapper"),o=require("jsuri"),t=require("bundles/profile/common/api/profile"),i=r("/api/onDemandClassmateProfiles.v1",{type:"rest"});exports.initProfileStore=function(o,r){var n=r.authenticated,u=r.courseId,d=r.externalId,i=r.userId;if(!o.getStore("ProfileStore").hasLoaded()&&n){var a=[o.executeAction(exports.getSocialProfile,{courseId:u,externalId:d})];return i&&a.push(e(t.get(i.toString(),{data:{fields:"fullName"}})).then(function(e){o.dispatch("INIT_PROFILE_STORE",e)})),e.all(a)}return e()},exports.getUserProfile=function(i,r){var a=r.authenticated,o=r.userId;if(a&&o)return e(t.get(o.toString(),{data:{fields:"fullName"}})).then(function(e){i.dispatch("RECEIVE_USER_PROFILE",e)});return e()},exports.getSocialProfile=function(r,t){var a=t.courseId,n=t.externalId,u=(new o).addQueryParam("courseId",a).addQueryParam("q","byExternalIds").addQueryParam("externalUserIds",n).addQueryParam("includes","userId,_links");return e(i.get(u.toString())).then(function(e){r.dispatch("RECEIVE_SOCIAL_PROFILE",e)})},exports.updateLocation=function(r){var o=r.getStore("ProfileStore").profile;return o.location=location,r.dispatch("UPDATE_LOCATION_START",location),e(t.put(o.userId+"",{data:o})).then(function(e){r.dispatch("UPDATE_LOCATION_SUCCESS",e)})},exports.updateProfileImage=function(i,t){var o={photo_120:t.photo120,photo_60:t.photo60,photo_24:t.photo24,photo:t.original,privacy:1e3},a=r("/maestro/api/user/save_profile");return e(a.post("",{data:o})).then(function(){i.dispatch("UPDATE_PROFILE_IMAGE_SUCCESS",o)})}});

define('css!bundles/profile/components/__styles__/ImageEditor',[],function(){})
define("bundles/profile/components/ImageEditor",["require","exports","module","react","jquery","i18n!nls/discussions","q","classnames","js/lib/transloadit","js/lib/util","vendor/cnpm/fluxible.v0-4/addons/connectToStores","bundles/profile/components/ReactAvatarEditor","bundles/iconfont/Icon","bundles/profile/actions/ProfileActions","css!bundles/profile/components/__styles__/ImageEditor.css"],function(require,exports,module){function _defaults(e,a){for(var s=Object.getOwnPropertyNames(a),t=0;t<s.length;t++){var o=s[t],r=Object.getOwnPropertyDescriptor(a,o);r&&r.configurable&&void 0===e[o]&&Object.defineProperty(e,o,r)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var r,a,e=require("react"),$=require("jquery"),t=require("i18n!nls/discussions"),n=require("q"),s=require("classnames"),l=require("js/lib/transloadit"),o=require("js/lib/util"),i=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores"),p=require("bundles/profile/components/ReactAvatarEditor"),c=require("bundles/iconfont/Icon"),u=require("bundles/profile/actions/ProfileActions"),d=u.updateProfileImage;require("css!bundles/profile/components/__styles__/ImageEditor.css");var f=(a=r=function(r){function ImageEditor(){var a,e,s;_classCallCheck(this,ImageEditor);for(var l=arguments.length,i=Array(l),t=0;l>t;t++)i[t]=arguments[t];return a=e=_possibleConstructorReturn(this,r.call.apply(r,[this].concat(i))),e.state={imageDataUrl:null,scale:1,uploadState:{state:"ready",progress:0},currentState:"upload"},e.handleSave=function(){var r=e.refs.avatar.props.width,a=e.refs.avatar.props.height,o=e.refs.avatar.getCropPositions(),s=o.width,t=e.origImgDims.width/s,n={x1:o.x*t,y1:o.y*t,x2:o.x*t+r*t,y2:o.y*t+a*t};e.createUploader(n)},e.handleScale=function(){var t=e.refs.scale.value;e.setState({scale:t})},e.onError=function(t){"uploading"===e.state.uploadState.state&&e.uploader.cancel(),e.setState({uploadState:{state:"error",progress:0,error:t}}),e.props.onUploadError&&e.props.onUploadError(t),e.reset()},e.onCancel=function(){e.props.onUploadCancel&&e.props.onUploadCancel()},e.onStart=function(){e.props.onUploadStart&&e.props.onUploadStart()},e.onUploadComplete=function(t,o){e.props.onUploadComplete&&e.props.onUploadComplete(t,o)},e.onResult=function(t,o){e.props.onUploadResult&&e.props.onUploadResult(t,o)},e.onSelect=function(){e.setState({uploadState:{state:"uploading",progress:0}}),e.props.onUploadSelect&&e.props.onUploadSelect()},e.onSuccess=function(t){if(e.setState({uploadState:{state:"uploaded",progress:100}}),!t.results[":original"])return e.handleUploadError(),void e.reset();var r={photo120:o.makeHttps(t.results.resize_to_120[0].url),photo60:o.makeHttps(t.results.resize_to_60[0].url),photo24:o.makeHttps(t.results.resize_to_24[0].url),original:o.makeHttps(t.results[":original"][0].url)};n(e.context.executeAction(d,r)).then(function(){e.setState({uploadState:{state:"saved",progress:100}}),setTimeout(function(){e.props.onCloseEditor()},2e3)},function(t){e.setState({uploadState:{state:"error"}})}).done()},e.onProgress=function(t){var a=t.bytes_received,o=t.bytes_expected,r=0===o?0:100*a/o;e.setState({uploadState:{state:"uploading",progress:r}}),e.props.onUploadProgress&&e.props.onUploadProgress(r)},e.onNewFile=function(){var t=e.refs.file;if(t.files[0]){var o=new FileReader;o.readAsDataURL(t.files[0]),o.onloadend=function(o){var t=new Image;t.src=o.target.result,e.origImgDims={width:t.width,height:t.height},e.setState({currentState:"edit",imageDataUrl:o.target.result})}}},e.openFileUpload=function(){e.refs.file.click()},e.closeEditor=function(){e.props.onCloseEditor()},s=a,_possibleConstructorReturn(e,s)}return _inherits(ImageEditor,r),ImageEditor.prototype.componentDidMount=function componentDidMount(){this.refs.uploadButton.click()},ImageEditor.prototype.handleUploadError=function handleUploadError(e){this.onError(e)},ImageEditor.prototype.removeUploader=function removeUploader(){if(!this.uploader)return;this.uploader.reset(),this.uploader.off("select",this.onSelect),this.uploader.off("start",this.onStart),this.uploader.off("progress",this.onProgress),this.uploader.off("upload-complete",this.onUploadComplete),this.uploader.off("result",this.onResult),this.uploader.off("success",this.onSuccess),this.uploader.off("error",this.onError),this.uploader.off("cancel",this.onCancel),this.uploader=null},ImageEditor.prototype.reset=function reset(){this.removeUploader()},ImageEditor.prototype.createUploader=function createUploader(e){var t={wait:!0,params:{auth:{key:"05912e90e83346abb96c261bf458b615"},template_id:"8f4ad5202f0b11e5884b378d02f4564a",steps:{crop:{crop:e}}}};this.uploader=l(this.refs.uploader,t),this.uploader.on("select",this.onSelect),this.uploader.on("start",this.onStart),this.uploader.on("progress",this.onProgress),this.uploader.on("upload-complete",this.onUploadComplete),this.uploader.on("result",this.onResult),this.uploader.on("success",this.onSuccess),this.uploader.on("error",this.onError),this.uploader.on("cancel",this.onCancel),this.uploader.$files=$(this.refs.uploader).find("input[type=file]"),this.uploader.submit(),this.onSelect()},ImageEditor.prototype.renderImageEditing=function renderImageEditing(){return e.createElement("div",null,e.createElement("p",{className:"headline-2-text align-horizontal-center"},t("Edit your photo")),e.createElement("div",{className:"contents"},e.createElement(p,{ref:"avatar",rotation:this.state.rotation,scale:parseFloat(this.state.scale),onSave:this.handleSave,image:this.state.imageDataUrl}),this.renderUploadState(),"ready"===this.state.uploadState.state&&e.createElement("div",{className:"work-area"},e.createElement("input",{name:"scale",type:"range",ref:"scale",onChange:this.handleScale,min:"1",max:"2",step:"0.01",defaultValue:"1"}),e.createElement("div",{className:"horizontal-box button-box align-items-absolute-center"},e.createElement("button",{className:"passive",onClick:this.closeEditor},t("Cancel")),e.createElement("button",{className:"secondary",onClick:this.handleSave},t("Save"))))))},ImageEditor.prototype.renderUploadState=function renderUploadState(){if("uploading"===this.state.uploadState.state){var o=this.state.uploadState.progress||0,r=Math.min(Math.max(o,5),95).toFixed(2),a={width:r+"%"};return e.createElement("div",{className:"work-area"},e.createElement("div",{className:"bt3-progress"},e.createElement("div",{className:"bt3-progress-bar",style:a})),e.createElement("div",{className:"color-hint-text label-text align-horizontal-center"},t("Uploading ...")))}if("saved"===this.state.uploadState.state)return e.createElement("div",{className:"work-area horizontal-box align-items-absolute-center saved"},e.createElement(c,{name:"checkmark",className:"cif-fw"}),t("Your photo is saved!"));return void 0},ImageEditor.prototype.renderErrorState=function renderErrorState(){if("error"===this.state.uploadState.state)return e.createElement("div",{className:"caption-text error"},t("Sorry, something went wrong. Please try again."));return void 0},ImageEditor.prototype.renderUploadButton=function renderUploadButton(){var o=s("vertical-box","align-items-absolute-center",{hide:"upload"!==this.state.currentState});return e.createElement("div",{className:o},e.createElement("a",{ref:"uploader"},e.createElement("input",{type:"file",name:"file",ref:"file",multiple:"false",className:"hide",onChange:this.onNewFile,accept:"image/x-png, image/gif, image/jpeg"}),e.createElement("button",{className:"passive align-horizontal-center",ref:"uploadButton",onClick:this.openFileUpload},t("Upload Photo"))))},ImageEditor.prototype.render=function render(){return e.createElement("section",{className:"rc-ImageEditor vertical-box align-items-absolute-center"},this.renderUploadButton(),"edit"===this.state.currentState&&this.renderImageEditing(),this.renderErrorState())},ImageEditor}(e.Component),r.propTypes={onCloseEditor:e.PropTypes.func.isRequired,onUploadCancel:e.PropTypes.func,onUploadError:e.PropTypes.func,onUploadStart:e.PropTypes.func,onUploadComplete:e.PropTypes.func,onUploadResult:e.PropTypes.func,onUploadSelect:e.PropTypes.func,onUploadProgress:e.PropTypes.func,className:e.PropTypes.string},r.contextTypes={executeAction:e.PropTypes.func.isRequired},a);module.exports=i(f,["ProfileStore"],function(e){return{}})});

define('css!bundles/profile/components/__styles__/ImageEditorModal',[],function(){})
define("bundles/profile/components/ImageEditorModal",["require","exports","module","react","bundles/phoenix/components/Modal","bundles/phoenix/template/models/userIdentity","bundles/profile/components/ImageEditor","css!bundles/profile/components/__styles__/ImageEditorModal.css"],function(require,exports,module){function _defaults(e,r){for(var s=Object.getOwnPropertyNames(r),t=0;t<s.length;t++){var o=s[t],n=Object.getOwnPropertyDescriptor(r,o);n&&n.configurable&&void 0===e[o]&&Object.defineProperty(e,o,n)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var o,t,e=require("react"),n=require("bundles/phoenix/components/Modal"),i=require("bundles/phoenix/template/models/userIdentity"),r=require("bundles/profile/components/ImageEditor");require("css!bundles/profile/components/__styles__/ImageEditorModal.css");var s=(t=o=function(t){function ImageEditorModal(){var n,e,r;_classCallCheck(this,ImageEditorModal);for(var s=arguments.length,i=Array(s),o=0;s>o;o++)i[o]=arguments[o];return n=e=_possibleConstructorReturn(this,t.call.apply(t,[this].concat(i))),e.closeModal=function(){e.props.onEditingComplete()},r=n,_possibleConstructorReturn(e,r)}return _inherits(ImageEditorModal,t),ImageEditorModal.prototype.render=function render(){return e.createElement("div",{className:"rc-ImageEditorModal"},e.createElement(n,{handleClose:this.closeModal,ref:"editPhoto"},e.createElement(r,{onCloseEditor:this.closeModal})))},ImageEditorModal}(e.Component),o.propTypes={onEditingComplete:e.PropTypes.func.isRequired},t);module.exports=s});
define("bundles/profile/components/ProfileImageUploader",["require","exports","module","react","vendor/cnpm/fluxible.v0-4/addons/connectToStores","bundles/profile/components/ImageEditorButton","bundles/profile/components/ImageEditorModal","bundles/phoenix/components/ProfileImage"],function(require,exports,module){function _defaults(e,r){for(var i=Object.getOwnPropertyNames(r),t=0;t<i.length;t++){var o=i[t],n=Object.getOwnPropertyDescriptor(r,o);n&&n.configurable&&void 0===e[o]&&Object.defineProperty(e,o,n)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var t,o,e=require("react"),n=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores"),r=require("bundles/profile/components/ImageEditorButton"),i=require("bundles/profile/components/ImageEditorModal"),l=require("bundles/phoenix/components/ProfileImage"),a=(o=t=function(t){function ProfileImageUploader(){var n,e,r;_classCallCheck(this,ProfileImageUploader);for(var i=arguments.length,l=Array(i),o=0;i>o;o++)l[o]=arguments[o];return n=e=_possibleConstructorReturn(this,t.call.apply(t,[this].concat(l))),e.state={showModal:!1},e.onImageEditorClick=function(){e.setState({showModal:!0})},e.editingComplete=function(){e.setState({showModal:!1})},r=n,_possibleConstructorReturn(e,r)}return _inherits(ProfileImageUploader,t),ProfileImageUploader.prototype.render=function render(){return e.createElement("div",{className:"rc-ProfileImageUploader"},this.props.profileImageUrl?e.createElement(l,{profileImageUrl:this.props.profileImageUrl,width:36,height:36}):e.createElement("div",null,e.createElement(r,{ref:"editorButton",onButtonClick:this.onImageEditorClick,mini:this.props.mini}),this.state.showModal&&e.createElement(i,{onEditingComplete:this.editingComplete})))},ProfileImageUploader}(e.Component),t.propTypes={mini:e.PropTypes.bool,profileImageUrl:e.PropTypes.string},o);module.exports=n(a,["ProfileStore"],function(e){return{profileImageUrl:e.ProfileStore.getProfileImage()}})});
define("bundles/discussions/components/discussionPrompt/DiscussionPromptComponents",["require","exports","module","react","react-router","underscore","q","bundles/phoenix/lib/apiWrapper","jsuri","bundles/discussions/utils/discussionsUrl","bundles/iconfont/Icon","js/lib/getPropsFromPromise","js/lib/waitFor","bundles/discussions/components/repliesList/ReplyCMLInput","bundles/profile/components/ProfileImageUploader","bundles/phoenix/components/ProfileImage","bundles/discussions/utils/threadUtils","i18n!nls/discussions"],function(require,exports,module){function _defaults(e,s){for(var o=Object.getOwnPropertyNames(s),t=0;t<o.length;t++){var n=o[t],r=Object.getOwnPropertyDescriptor(s,n);r&&r.configurable&&void 0===e[n]&&Object.defineProperty(e,n,r)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var i,a,p,c,s,o,e=require("react"),w=require("react-router"),q=w.Link,_=require("underscore"),r=require("q"),u=require("bundles/phoenix/lib/apiWrapper"),l=require("jsuri"),d=require("bundles/discussions/utils/discussionsUrl"),m=d.buildUrlForDiscussionPrompt,f=require("bundles/iconfont/Icon"),h=require("js/lib/getPropsFromPromise"),b=require("js/lib/waitFor"),g=require("bundles/discussions/components/repliesList/ReplyCMLInput"),y=require("bundles/profile/components/ProfileImageUploader"),P=require("bundles/phoenix/components/ProfileImage"),v=require("bundles/discussions/utils/threadUtils"),I=v.formatCount,t=require("i18n!nls/discussions"),n=4,E=(a=i=function(t){function RespondedLearnersImage(){var r,e,s;_classCallCheck(this,RespondedLearnersImage);for(var o=arguments.length,i=Array(o),n=0;o>n;n++)i[n]=arguments[n];return r=e=_possibleConstructorReturn(this,t.call.apply(t,[this].concat(i))),e.state={images:[]},e.receiveReponderImages=function(t){var n=t.linked["profiles.v0"];e.setState({images:n.map(function(e){return{image:e.photoUrl,name:e.fullName}})})},s=r,_possibleConstructorReturn(e,s)}return _inherits(RespondedLearnersImage,t),RespondedLearnersImage.prototype.componentWillMount=function componentWillMount(){if(this.props.responseCount){var e=u("/api/onDemandDiscussionAnswers.v1/",{type:"rest"}),t=(new l).addQueryParam("q","byQuestion").addQueryParam("questionId",this.props.questionId).addQueryParam("sort","createdAtDesc").addQueryParam("limit",n).addQueryParam("includes","creatorId,_links");r(e.get(t.toString())).then(this.receiveReponderImages).done()}},RespondedLearnersImage.prototype.renderMorePeopleImage=function renderMorePeopleImage(){if(this.props.responseCount>n){var t=I(this.props.responseCount-n,!0);return e.createElement("li",{className:"bgcolor-black-g3"},e.createElement("div",{className:"horizontal-box align-items-absolute-center num-responder-images caption-text"},"+",t))}return null},RespondedLearnersImage.prototype.render=function render(){var t=this.state.images;if(0===t.length)return null;return e.createElement("ul",{className:"nostyle horizontal-box align-items-absolute-center learner-image-list"},t.map(function(t){var n=t.name,r=t.image;return e.createElement("li",{key:n},e.createElement(P,{width:32,height:32,fullName:n,profileImageUrl:r}))}),this.renderMorePeopleImage())},RespondedLearnersImage}(e.Component),i.propTypes={questionId:e.PropTypes.string.isRequired,responseCount:e.PropTypes.number.isRequired},a),x=(c=p=function(n){function Input(){return _classCallCheck(this,Input),_possibleConstructorReturn(this,n.apply(this,arguments))}return _inherits(Input,n),Input.prototype.render=function render(){var n=this.props,r=n.question,s=n.savingState,o=n.placeholder;return e.createElement("div",{className:"horizontal-box align-items-left theme-light c-prompt-card"},e.createElement(y,null),e.createElement("div",{className:"flex-1"},e.createElement(g,{hideFollow:!0,question:r,parentPost:r,savingState:s,placeholder:t(o)})))},Input}(e.Component),p.propTypes={placeholder:e.PropTypes.string.isRequired,question:e.PropTypes.object.isRequired,savingState:e.PropTypes.string.isRequired},c),N=function(n){function Saving(){return _classCallCheck(this,Saving),_possibleConstructorReturn(this,n.apply(this,arguments))}return _inherits(Saving,n),Saving.prototype.render=function render(){return e.createElement("div",{className:"horizontal-box align-items-absolute-center bgcolor-white c-prompt-card color-hint-text"},e.createElement(f,{name:"spinner",className:"cif-spin"}),e.createElement("span",{className:"caption-text"},t("Submitting Your Response")))},Saving}(e.Component),j=(o=s=function(n){function Completed(){return _classCallCheck(this,Completed),_possibleConstructorReturn(this,n.apply(this,arguments))}return _inherits(Completed,n),Completed.prototype.render=function render(){return e.createElement("div",{className:"vertical-box align-items-absolute-center bgcolor-white c-prompt-card"},e.createElement("span",{className:"color-secondary-text"},t("Your response has been submitted. Engage and discuss with other learners below!")),e.createElement("button",{className:"secondary c-prompt-link-button"},e.createElement(q,{className:"nostyle",to:this.props.url},t("View My Response"))))},Completed}(e.Component),s.propTypes={showLink:e.PropTypes.bool,questionId:e.PropTypes.string.isRequired,url:e.PropTypes.string},o);module.exports={Input:x,Saving:N,Completed:_.compose(h(function(e){if(e.showLink){var t=u("/api/onDemandDiscussionAnswers.v1/",{type:"rest"}),n=(new l).addQueryParam("q","byQuestionAndUser").addQueryParam("questionId",e.questionId).addQueryParam("userId",e.userId).addQueryParam("includes","creatorId,flagId,_links").addQueryParam("sort","createdAtAsc").toString();return r(t.get(n)).then(function(e){if(!e.elements.length)return{url:void 0};return{url:m(e.elements[0].id)}})}return r({url:void 0})}),b(function(e){return e.url}))(j),RespondedLearnersImage:E}});
define("js/json/nls/universities",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("js/json/nls/languages",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});
define("js/json/nls/topics",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});

define('css!bundles/socialPlugins/wechat/__styles__/wechat-button',[],function(){})
define("nls/socialPlugins",["require","exports","module"],function(require,exports,module){module.exports={es:!0,fr:!0,pseudo:!0,pt:!0,ru:!0,tr:!0,zh:!0,"zh-hk":"zh-tw","zh-mo":"zh-tw","zh-tw":!0}});


define('css!bundles/discussions/components/discussionPrompt/__styles__/DiscussionPrompt',[],function(){})
define("bundles/discussions/components/discussionPrompt/DiscussionPrompt",["require","exports","module","react","underscore","q","jsuri","bundles/profile/constants/constants","js/lib/connectToRouter","vendor/cnpm/fluxible.v0-4/addons/connectToStores","bundles/iconfont/Icon","bundles/cml/components/CML","js/lib/coursera.react-intl","bundles/discussions/components/repliesList/RepliesList","bundles/discussions/components/discussionPrompt/DiscussionPromptComponents","bundles/discussions/actions/ThreadDetailsActions","bundles/discussions/components/discussionsForumsHOC","bundles/discussions/utils/routerConnectToCurrentForum","bundles/naptimejs/resources/onDemandCourseForums.v1","bundles/discussions/utils/hydrateQuestionsAndAnswers","bundles/discussions/api/questions","bundles/discussions/constants","vendor/cnpm/fluxible.v0-4/addons/FluxibleComponent","bundles/discussions/app","i18n!nls/discussions","css!./__styles__/DiscussionPrompt"],function(require,exports,module){function _defaults(e,o){for(var r=Object.getOwnPropertyNames(o),t=0;t<r.length;t++){var s=r[t],n=Object.getOwnPropertyDescriptor(o,s);n&&n.configurable&&void 0===e[s]&&Object.defineProperty(e,s,n)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var d=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},r,c,p,i,e=require("react"),b=require("underscore"),C=b.compose,O=require("q"),R=require("jsuri"),M=require("bundles/profile/constants/constants"),t=M.savingStates,m=require("js/lib/connectToRouter"),h=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores"),f=require("bundles/iconfont/Icon"),y=require("bundles/cml/components/CML"),a=require("js/lib/coursera.react-intl"),l=a.FormattedNumber,v=a.FormattedMessage,g=require("bundles/discussions/components/repliesList/RepliesList"),o=require("bundles/discussions/components/discussionPrompt/DiscussionPromptComponents"),I=o.Input,w=o.Saving,S=o.Completed,x=o.RespondedLearnersImage,E=require("bundles/discussions/actions/ThreadDetailsActions"),T=E.fetchAnswers,P=require("bundles/discussions/components/discussionsForumsHOC"),q=require("bundles/discussions/utils/routerConnectToCurrentForum"),D=require("bundles/naptimejs/resources/onDemandCourseForums.v1"),A=require("bundles/discussions/utils/hydrateQuestionsAndAnswers"),j=A.legacyHydrate,N=require("bundles/discussions/api/questions"),s=require("bundles/discussions/constants"),F=require("vendor/cnpm/fluxible.v0-4/addons/FluxibleComponent"),L=require("bundles/discussions/app"),n=require("i18n!nls/discussions");require("css!./__styles__/DiscussionPrompt");var u=(c=r=function(o){function DiscussionPrompt(n,r){_classCallCheck(this,DiscussionPrompt);var e=_possibleConstructorReturn(this,o.call(this,n,r));return e.receiveThreadData=function(n){var o=j(n),t=o[0];t.questionId=t.id,t.type="question",e._isMounted&&(e.fetchAnswers(t.id,s.answerSorts.newestSort,e.props.page),e.setState({question:t,questionId:t.id,promptTitle:t.content.question,promptContent:t.content.details,learnerCount:t.answerCount||t.topLevelAnswerCount,loaded:!0}))},e.state={learnerCount:void 0,savingState:t.UNCHANGED,forumError:!1},e}return _inherits(DiscussionPrompt,o),DiscussionPrompt.prototype.componentWillMount=function componentWillMount(){this.fetchThreadData()},DiscussionPrompt.prototype.componentDidMount=function componentDidMount(){this._isMounted=!0},DiscussionPrompt.prototype.componentWillReceiveProps=function componentWillReceiveProps(n){this.setState({savingState:n.savingStates[this.state.questionId]||t.UNCHANGED});var e=this.state.questionId;e&&this.props.savingStates[e]===t.SAVING&&n.savingStates[e]===t.SAVED&&this.fetchAnswers(e,s.answerSorts.newestSort,this.props.page)},DiscussionPrompt.prototype.componentDidUpdate=function componentDidUpdate(e,t){e.page!==this.props.page&&this.fetchAnswers(this.state.questionId,s.answerSorts.newestSort,this.props.page)},DiscussionPrompt.prototype.componentWillUnmount=function componentWillUnmount(){this._isMounted=!1},DiscussionPrompt.prototype.fetchAnswers=function fetchAnswers(t,s,n){var e=this.props,o=e.userId,r=e.courseId,i=e.currentForum;this.context.executeAction(T,{questionId:t,sort:s,page:n,contextId:r,userId:o,forumType:i.forumType.typeName})},DiscussionPrompt.prototype.fetchThreadData=function fetchThreadData(){var e=this,t=(new R).addQueryParam("q","byPromptItem").addQueryParam("courseId",this.props.courseId).addQueryParam("itemId",this.context.router.params.item_id).addQueryParam("sort",s.answerSorts.newestSort).addQueryParam("includes","creatorId,flagId,_links");O(N.get(t.toString())).then(this.receiveThreadData)["catch"](function(t){console.error(t),e.setState({forumError:!0})}).done()},DiscussionPrompt.prototype.renderLoading=function renderLoading(){return e.createElement("div",{className:"vertical-box align-items-vertical-center"},e.createElement(f,{name:"spinner",className:"cif-spin cif-3x"}))},DiscussionPrompt.prototype.renderInput=function renderInput(){return e.createElement("div",null,e.createElement("div",{className:"color-hint-text participation-text"},n("Participation is optional")),e.createElement(I,{savingState:this.state.savingState,question:this.state.question,placeholder:n("Type your response here...")}),e.createElement(x,{questionId:this.state.questionId,responseCount:this.state.learnerCount}),e.createElement("div",{className:"horizontal-box align-items-absolute-center caption-text color-secondary-text"},this.state.learnerCount&&this.state.learnerCount>0?e.createElement("div",null,e.createElement(l,{value:this.state.learnerCount}),"Â ",e.createElement(v,{message:n("{learnerCount, plural, =1 { learner has} other { learners have}}\n     submitted a response."),learnerCount:this.state.learnerCount})):e.createElement("div",null,n("Be the first to submit a response"))))},DiscussionPrompt.prototype.renderError=function renderError(){return e.createElement("div",{className:"horizontal-box align-items-absolute-center bgcolor-white c-prompt-card"},e.createElement("span",{className:"caption-text color-secondary-text"},n("Sorry, we were unable to retrieve a forum.")))},DiscussionPrompt.prototype.renderCompleted=function renderCompleted(){return e.createElement("div",null,e.createElement(S,{showLink:this.props.previouslyCompleted,questionId:this.state.questionId,userId:this.props.userId}),e.createElement("div",{className:"c-thread-container"},e.createElement(g,{sort:s.answerSorts.newestSort,page:this.props.page,forumId:this.props.currentForum.id,questionId:this.state.questionId,answerId:this.props.answerId,forumLink:this.props.currentForumUrl})))},DiscussionPrompt.prototype.renderContent=function renderContent(){var s=this.state.savingState;if(s===t.SAVED||this.props.previouslyCompleted)return this.renderCompleted();if(s===t.UNCHANGED)return this.renderInput();if(s===t.SAVING)return e.createElement(w,null);return!1},DiscussionPrompt.prototype.renderBody=function renderBody(){return e.createElement("div",null,e.createElement("span",null,e.createElement(y,{cml:this.state.promptContent})),this.renderContent())},DiscussionPrompt.prototype.render=function render(){var t=this.state.loaded;return e.createElement("div",{className:"rc-DiscussionPrompt"},!this.state.forumError&&(t?this.renderBody():this.renderLoading()),this.state.forumError&&this.renderError())},DiscussionPrompt}(e.Component),r.propTypes={itemMetadata:e.PropTypes.object.isRequired,savingStates:e.PropTypes.object.isRequired,page:e.PropTypes.number,answerId:e.PropTypes.string,userId:e.PropTypes.number,courseId:e.PropTypes.string,currentForum:e.PropTypes.instanceOf(D),previouslyCompleted:e.PropTypes.bool.isRequired,currentForumUrl:e.PropTypes.string},r.contextTypes={executeAction:e.PropTypes.func.isRequired,router:e.PropTypes.object.isRequired},c),U=C(P({fields:["forumType","urlId"]}),m(function(e,t){return d({},q(e,t),{page:e.location.query.page?parseInt(e.location.query.page,10):1,answerId:e.location.query.answerId?e.location.query.answerId:void 0})}),h(["ThreadDetailsStore","ApplicationStore"],function(e,t){var s=e.ThreadDetailsStore,n=e.ApplicationStore,o=t.itemMetadata;return{savingStates:Object.assign({},s.savingStates),userId:n.getUserData().id}}))(u);module.exports=(i=p=function(t){function FluxibleConnectedDiscussionPrompt(){return _classCallCheck(this,FluxibleConnectedDiscussionPrompt),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(FluxibleConnectedDiscussionPrompt,t),FluxibleConnectedDiscussionPrompt.prototype.componentWillMount=function componentWillMount(){this.fluxibleContext=L(this.context.fluxibleContext)},FluxibleConnectedDiscussionPrompt.prototype.render=function render(){return e.createElement(F,{context:this.fluxibleContext.getComponentContext()},e.createElement(U,this.props))},FluxibleConnectedDiscussionPrompt}(e.Component),p.contextTypes={fluxibleContext:e.PropTypes.object},i),module.exports.BaseComp=u});

define('css!bundles/ondemand/components/discussionPrompt/__styles__/DiscussionPromptWrapper',[],function(){})
define("bundles/ondemand/components/discussionPrompt/DiscussionPromptWrapper",["require","exports","module","react","underscore","vendor/cnpm/fluxible.v0-4/addons/connectToStores","bundles/content-feedback/constants/ItemTypes","bundles/ondemand/components/item/LightItemLayout","bundles/ondemand/components/LockingCover","bundles/discussions/components/discussionPrompt/DiscussionPrompt","css!./__styles__/DiscussionPromptWrapper"],function(require,exports,module){function _defaults(e,n){for(var r=Object.getOwnPropertyNames(n),t=0;t<r.length;t++){var o=r[t],s=Object.getOwnPropertyDescriptor(n,o);s&&s.configurable&&void 0===e[o]&&Object.defineProperty(e,o,s)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var o,s,e=require("react"),m=require("underscore"),n=m.compose,r=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores"),i=require("bundles/content-feedback/constants/ItemTypes"),c=require("bundles/ondemand/components/item/LightItemLayout"),a=require("bundles/ondemand/components/LockingCover"),p=require("bundles/discussions/components/discussionPrompt/DiscussionPrompt");require("css!./__styles__/DiscussionPromptWrapper");var t=(s=o=function(t){function DiscussionPromptWrapper(){return _classCallCheck(this,DiscussionPromptWrapper),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(DiscussionPromptWrapper,t),DiscussionPromptWrapper.prototype.render=function render(){return e.createElement("div",{className:"rc-DiscussionPromptWrapper"},e.createElement(c,{itemMetadata:this.props.itemMetadata,subItemId:this.props.itemMetadata.get("id"),itemType:i.DiscussionPrompt,isCard:!0},e.createElement("div",null,e.createElement("div",{className:"vertical-box align-items-vertical-center"},e.createElement("div",null,e.createElement("span",{className:"cif-stack cif-2x"},e.createElement("i",{className:"cif-circle cif-stack-2x c-prompt-icon"}),e.createElement("i",{className:"cif-comment cif-stack-1x cif-inverse comment-icon"}))),e.createElement("h4",{className:"c-prompt-title"},this.props.itemMetadata.get("name"))),this.props.isItemLocked?e.createElement(a,{itemMetadata:this.props.itemMetadata}):e.createElement(p,{itemMetadata:this.props.itemMetadata,previouslyCompleted:this.props.isComplete}))))},DiscussionPromptWrapper}(e.Component),o.propTypes={itemMetadata:e.PropTypes.object.isRequired,isComplete:e.PropTypes.bool.isRequired,isItemLocked:e.PropTypes.bool},s);module.exports=n(r(["CourseStore","CourseMembershipStore","ProgressStore","ApplicationStore"],function(e,o){var i=e.CourseStore,s=e.CourseMembershipStore,n=e.ProgressStore,r=e.ApplicationStore,t=o.itemMetadata;return{isComplete:n.isItemComplete(t),isItemLocked:!r.getUserData().id||!s.isEnrolled()||t.isLockedForSessions()}}))(t),module.exports.BaseComp=t});

(function(c){var d=document,a='appendChild',i='styleSheet',s=d.createElement('style');s.type='text/css';d.getElementsByTagName('head')[0][a](s);s[i]?s[i].cssText=c:s[a](d.createTextNode(c));})
('.scribe-image-upload-command-loader{background:#fff;position:absolute;padding:5px 15px;border:1px solid #aaa}.scribe-image-upload-command-in-progress{opacity:.1;-ms-filter:\"progid:DXImageTransform.Microsoft.Alpha(Opacity=10)\";filter:alpha(opacity=10)}.bt3-clearfix:before,.bt3-clearfix:after{content:\" \";display:table}.bt3-clearfix:after{clear:both}.rc-ProfileImage .c-profile-image{-webkit-border-radius:100%;border-radius:100%;}.rc-ProfileImage .c-profile-image img{-webkit-border-radius:100%;border-radius:100%}.rc-ProfileImage .c-profile-initials{background-color:#3277b2;color:#fff;text-transform:uppercase;}.rc-ProfileImage .c-profile-initials div{width:100%;height:100%;}.rc-ProfileImage .c-profile-initials div p{margin-bottom:0}.bt3-clearfix:before,.bt3-clearfix:after{content:\" \";display:table}.bt3-clearfix:after{clear:both}.rc-MiniProfile{position:absolute;z-index:9999;opacity:0;-ms-filter:\"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)\";filter:alpha(opacity=0);}.rc-MiniProfile.transition-in{opacity:1;-ms-filter:none;filter:none;-webkit-transition:opacity 0.3s ease-in;-moz-transition:opacity 0.3s ease-in;-o-transition:opacity 0.3s ease-in;-ms-transition:opacity 0.3s ease-in;transition:opacity 0.3s ease-in}.rc-MiniProfile .profile-header{margin:16px 12px 12px;}.rc-MiniProfile .profile-header .profile-photo{margin-bottom:12px}.rc-MiniProfile .profile-footer{padding:12px 16px 16px}.rc-MiniProfile .loading-state{text-align:center;margin:48px}.rc-MiniProfile .dot-spacing{margin:0 4px}.rc-MiniProfile.profileAreaNorth{margin-top:-205px}.rc-MiniProfile.profileAreaSouth{margin-top:5px}.rc-MiniProfile.profileNameNorth{margin-top:-185px}.rc-MiniProfile.profileNameSouth{margin-top:5px}.rc-ModerationReasons .c-radio-group{list-style-type:none;padding-left:0}.rc-ModerationReasons li{margin:0 0 16px 16px}.rc-ModerationReasons a{text-decoration:underline}.rc-ModerationReasons label{font-weight:normal}.rc-ModerationReasons .c-radio-label{display:inline-block;padding-left:16px}.rc-ImageEditorButton button.camera{-webkit-border-radius:100%;border-radius:100%;width:52px;height:52px;min-width:0;padding:0}.rc-ImageEditorButton button.secondary i{margin:0}.rc-ImageEditorButton input[type=\"file\"]{display:none}.rc-ImageEditorButton .button-box button:first-child{margin-right:8px}.rc-ImageEditorButton.mini button.camera{width:36px;height:36px;margin:2px 0 0 2px}.bt3-clearfix:before,.bt3-clearfix:after{content:\" \";display:table}.bt3-clearfix:after{clear:both}.rc-ImageEditor{padding:24px;width:100%;height:100%;}.rc-ImageEditor p{margin-bottom:20px}.rc-ImageEditor .button-box{margin-top:20px;}.rc-ImageEditor .button-box button:first-child{margin-right:8px}.rc-ImageEditor .contents{max-width:250px}.rc-ImageEditor .hide{display:none}.rc-ImageEditor .work-area{width:250px;min-height:72px;}.rc-ImageEditor .work-area .bt3-progress{height:8px;margin:8px 0;}.rc-ImageEditor .work-area .bt3-progress .bt3-progress-bar{background-color:#f6faff}.rc-ImageEditor .saved{color:#1f8354}.rc-ImageEditor .error{color:#ff707f}.rc-ImageEditorModal .rc-Modal.box .c-modal-content{width:320px;height:424px;padding:0;}.rc-ImageEditorModal .rc-Modal.box .c-modal-content .c-modal-x-out{top:12px;right:16px;font-size:16px}.wechat-image{cursor:pointer}.wechat-qrcode-container{background:#fff;border:1px solid #ccc;position:absolute;z-index:100;width:260px;height:130px;font-size:13px;right:10px;top:-120px;margin-top:20px;-webkit-box-shadow:0 3px 7px rgba(0,0,0,0.3);box-shadow:0 3px 7px rgba(0,0,0,0.3)}#wechat-qrcode{display:inline-block;margin:20px 10px;float:left}.wechat-qrcode-message{display:inline-block;width:120px;height:90px;margin:20px 10px;line-height:20px;text-align:left}.wechat-qrcode-close{position:absolute;top:0;right:8px;cursor:pointer}.bt3-clearfix:before,.bt3-clearfix:after{content:\" \";display:table}.bt3-clearfix:after{clear:both}.rc-DiscussionPrompt .rc-RepliesSortBar{display:none}.rc-DiscussionPrompt .rc-RepliesList{-webkit-box-shadow:none;box-shadow:none}.rc-DiscussionPrompt .c-prompt-icon{color:#2a73cc}.rc-DiscussionPrompt .c-prompt-card{margin:24px 0 40px;padding:28px 34px 34px;background-color:rgba(0,0,0,0.05);}.rc-DiscussionPrompt .c-prompt-card .flex-1{margin-left:18px}.rc-DiscussionPrompt .c-prompt-card .c-prompt-link-button{margin-top:20px}.rc-DiscussionPrompt .c-thread-container{max-width:682px;margin:0 auto}.rc-DiscussionPrompt .c-item-header-container{padding:12px}.rc-DiscussionPrompt .rc-LocationInput{width:80%;}.rc-DiscussionPrompt .rc-LocationInput .rc-FormItemSave{top:10px}.rc-DiscussionPrompt ul.learner-image-list{margin-bottom:16px;}.rc-DiscussionPrompt ul.learner-image-list li{width:32px;height:32px;margin-right:4px;-webkit-border-radius:100%;border-radius:100%;}.rc-DiscussionPrompt ul.learner-image-list li .num-responder-images{color:#fff;height:100%}.rc-DiscussionPrompt .participation-text{margin-top:4px}.rc-DiscussionPromptWrapper .c-prompt-title{margin:16px 0 24px}.rc-DiscussionPromptWrapper .rc-LockingCover{height:inherit;min-height:240px;padding-left:24px}.rc-DiscussionPromptWrapper .comment-icon{font-size:20px}');
