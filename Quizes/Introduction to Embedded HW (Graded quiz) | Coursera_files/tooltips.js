define("js/lib/tooltips",["require","exports","module","js/lib/data.attributes","jquery","js/vendor/lucid.v2-7-0","underscore","js/lib/cookie"],function(require,exports,module){"use strict";var t=function Tooltips($,n,_,s,e){var a=27,t={defaults:{"bind.open":"mouseenter focusin","bind.close":"mouseleave focusout","bind.keydown":"keydown","animate.in.type":"custom","animate.in.from":'{"opacity":0}',"animate.in.to":'{"opacity":0.8}',"animate.in.duration":200,"animate.out.type":"custom","animate.out.from":'{"opacity":0.8}',"animate.out.to":'{"opacity":0}',"animate.out.duration":200,position:"top",style:"tooltip","style.position":"absolute","style.z-index":1e6,offset:10,"attribute.tooltip":"data-tooltip","onetime.cookie":null,"onetime.timeout":2e3},tooltip:$("<div>").attr("aria-role","tooltip"),getTooltip:function getTooltip(e,s){var o=$(e).data("tooltip.me");return o&&o.constructor==i.prototype.constructor?(t.build.call(o,o.options?o.options.text:null),s?o.customize(s):o):null},makeTooltip:function makeTooltip(n,s){var e=$(n),o=t.getTooltip(e);return o||(o=new i(e,s),e.data("tooltip.me",o)),t.build.call(o,s?s.text:null),o},monitorKeys:function monitorKeys(t){t.keyCode==a&&this.close()},show:function show(){this.emitter.trigger("show",this)},close:function close(){this.$tooltip.hide().remove(),this.emitter.trigger("close",this)},build:function build(i){if(this.options["onetime.cookie"]&&e.get(this.options["onetime.cookie"]))return;var o=$("<div>").addClass(this.options.style+"-arrow"),s=$("<div>").addClass(this.options.style+"-inner"),n=i||this.$el.attr(this.options["attribute.tooltip"]);this.$tooltip=t.tooltip.empty().remove().removeClass().stop(!0,!0).addClass(this.options.style).addClass(this.options.position).css({visibility:"hidden",position:this.options["style.position"],display:"block","z-index":this.options["style.z-index"]}).append(o).append(s.html(n))}},i=function Tooltip(t,i){this.$el=$(t),this.customize(i),this.emitter=n.emitter(this)};i.prototype.customize=function(i){return this.options=_.extend({},s.parse(this.$el,t.defaults,"data-tooltip-"),this.options||{},i),this.options.offset&&(this.options.offset=parseInt(this.options.offset,10)||0),this},i.prototype.open=function(){var o=this.options["onetime.cookie"];if(o){if(e.get(o))return this;e.set(o,"shown",{expires:36500});var h=this;setTimeout(function(){h.close()},this.options["onetime.timeout"])}var i=this.$el.offset();this.$tooltip.appendTo("body"),"fixed"===this.options["style.position"]&&(i=this.$el[0].getBoundingClientRect());var a=this.$el.outerWidth()||this.$el[0].getBoundingClientRect().width,p=this.$el.outerHeight()||this.$el[0].getBoundingClientRect().height,s=this.$tooltip.outerWidth(),n=this.$tooltip.outerHeight(),l=i.left+a/2,r=i.top+p/2;return"top"==this.options.position?this.$tooltip.css({left:l-s/2,top:i.top-n-this.options.offset}):"left"==this.options.position?this.$tooltip.css({left:i.left-s-this.options.offset,top:r-n/2}):"right"==this.options.position?this.$tooltip.css({left:i.left+a+this.options.offset,top:r-n/2}):this.$tooltip.css({left:l-s/2,top:i.top+p+this.options.offset}),"custom"==this.options["animate.in.type"]?(this.options["animate.in.from"]&&(_.isObject(this.options["animate.in.from"])?this.$tooltip.css(this.options["animate.in.from"]):_.isString(this.options["animate.in.from"])&&this.$tooltip.css($.parseJSON(this.options["animate.in.from"]))),this.$tooltip.css({visibility:"visible",display:"block"}),this.options["animate.in.to"]&&(_.isObject(this.options["animate.in.to"])?this.$tooltip.animate(this.options["animate.in.to"],{duration:this.options["animate.in.duration"],complete:_.bind(t.show,this)}):_.isString(this.options["animate.in.to"])&&this.$tooltip.animate($.parseJSON(this.options["animate.in.to"]),{duration:this.options["animate.in.duration"],complete:_.bind(t.show,this)}))):(this.emitter.trigger("opening",this),this.$tooltip.css({display:"block"}),t.show.call(this)),$(document).on(this.options["bind.keydown"]+".popup",_.bind(t.monitorKeys,this)),this},i.prototype.close=function(){"custom"==this.options["animate.out.type"]?(this.options["animate.out.from"]&&(_.isObject(this.options["animate.out.from"])?this.$tooltip.css(this.options["animate.out.from"]):_.isString(this.options["animate.out.from"])&&this.$tooltip.css($.parseJSON(this.options["animate.out.from"]))),this.options["animate.out.to"]&&(_.isObject(this.options["animate.out.to"])?this.$tooltip.animate(this.options["animate.out.to"],{duration:this.options["animate.out.duration"],complete:_.bind(t.close,this)}):_.isString(this.options["animate.out.to"])&&this.$tooltip.animate($.parseJSON(this.options["animate.out.to"]),{duration:this.options["animate.out.duration"],complete:_.bind(t.close,this)})),this.emitter.trigger("closing",this)):(this.emitter.trigger("closing",this),t.close.call(this))};var o=function external(){return t.getTooltip.apply(null,arguments)||t.makeTooltip.apply(this,arguments)};return o.start=function(n,o){var e=$(n),i=_.extend({},t.defaults,o);e.on(i["bind.open"]+".tooltip","["+i["attribute.tooltip"]+"]",function(a){var e=$(this);if("disabled"!=e.attr("disabled")){i=_.extend({},o,s.parse(e,t.defaults,"data-tooltip-"));var n=t.getTooltip(e,i)||t.makeTooltip(e,i);e.attr(i["attribute.tooltip"])&&(n.open(),n.on("open",function(){e.data("tooltip.it",n)}),n.on("close",function(){e.data("tooltip.it",null)}))}}),e.on(i["bind.close"]+".tooltip","["+i["attribute.tooltip"]+"]",function(a){var e=$(this);if(i=_.extend({},o,s.parse(e,t.defaults,"data-tooltip-")),!i["onetime.cookie"]){var n=t.getTooltip(e,i);n&&n.close()}})},o.stop=function(o){var t=$(o),i=t.data("tooltip.it");t.off(".tooltip"),i&&i.close()},o.start("body"),o},i=require("js/lib/data.attributes"),$=require("jquery"),o=require("js/vendor/lucid.v2-7-0"),_=require("underscore"),s=require("js/lib/cookie");module.exports=t($,o,_,i,s)});