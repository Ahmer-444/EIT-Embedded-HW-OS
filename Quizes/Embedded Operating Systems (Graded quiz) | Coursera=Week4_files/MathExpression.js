define("bundles/quiz-question-types/components/questions/mathExpression/MathExpression",["require","exports","module","underscore","classnames","react","bundles/quiz-question-types/components/inputs/TextInput","bundles/quiz-question-types/components/questions/mathExpression/MathExpressionFeedback","bundles/quiz-question-types/components/questions/mathExpression/MathExpressionPreview","bundles/quiz-question-types/models/MathExpressionQuestion","bundles/quiz-question-types/models/MathExpressionPreviewState","bundles/quiz-question-types/utils/LatexAPIUtils","i18n!nls/quiz-question-types","css!./__styles__/MathExpression"],function(require,exports,module){"use strict";function _defaults(e,i){for(var o=Object.getOwnPropertyNames(i),s=0;s<o.length;s++){var t=o[s],n=Object.getOwnPropertyDescriptor(i,t);n&&n.configurable&&void 0===e[t]&&Object.defineProperty(e,t,n)}return e}function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(s,e){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?s:e}function _inherits(s,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(s,e):_defaults(s,e))}var n,i,o,_=require("underscore"),l=require("classnames"),e=require("react"),u=require("bundles/quiz-question-types/components/inputs/TextInput"),p=require("bundles/quiz-question-types/components/questions/mathExpression/MathExpressionFeedback"),a=require("bundles/quiz-question-types/components/questions/mathExpression/MathExpressionPreview"),c=require("bundles/quiz-question-types/models/MathExpressionQuestion"),s=require("bundles/quiz-question-types/models/MathExpressionPreviewState"),t=s.STATES,r=t.IN_PROGRESS,d=t.SUCCESS,h=t.WARNING,q=t.ERROR,v=require("bundles/quiz-question-types/utils/LatexAPIUtils"),w=require("i18n!nls/quiz-question-types");require("css!./__styles__/MathExpression");var f=(i=n=function(t){function MathExpression(i){_classCallCheck(this,MathExpression);var e=_possibleConstructorReturn(this,t.call(this,i));o.call(e);var r=e.props.question,n=r.response;return e.state={value:n&&n.answer,preview:new s},e}return _inherits(MathExpression,t),MathExpression.prototype.componentDidMount=function componentDidMount(){var e=this.state.value;this.loadPreviewDebounced=_.debounce(this.loadPreview,500),e&&this.loadPreview(e)},MathExpression.prototype.render=function render(){var s=this.props,t=s.question,r=s.isDisabled,n=this.state,c=n.value,i=n.preview,o=t.feedback,d=l("coursera-assess-question-mathexpression-answer-input",{"coursera-assess-question-mathexpression-answer-input-error":i.error});return e.createElement("div",{className:"rc-MathExpression"},e.createElement("div",{className:"coursera-math-expression-input-container"},e.createElement(a,{preview:i}),e.createElement(u,{value:c,isDisabled:r,className:d,onChange:this.onInputChange,placeholder:w("Enter math expression here")})),o&&"Explained"===o.feedbackLevel&&e.createElement(p,{question:t}))},MathExpression}(e.Component),n.propTypes={question:e.PropTypes.instanceOf(c).isRequired,onAnswer:e.PropTypes.func.isRequired,isDisabled:e.PropTypes.bool},o=function _initialiseProps(){var e=this;this.onInputChange=function(i){var n=e.props,o=n.question,a=n.onAnswer,t=i.target.value,u=new s("",r);e.setState({value:t,preview:u}),e.loadPreviewDebounced(t),a(t&&o.createAnswer(t))},this.loadPreview=function(t){var n=void 0;t&&""!==t.trim()?(n=new s("",r),v.convert(t).done(e.updatePreview)):n=new s,e.setState({preview:n})},this.updatePreview=function(t){var i=t.message,n=void 0;if(t.success)if(_(t).has("warnings")&&t.warnings.length>0){var o=t.warnings;n=new s(i,h,o)}else n=new s(i,d);else n=new s(i,q);e.setState({preview:n})}},i);module.exports=f});