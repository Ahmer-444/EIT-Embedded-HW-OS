define("bundles/quiz/components/Quiz",["require","exports","module","react","bundles/phoenix/components/OrigamiRegion","bundles/quiz/components/QuizBody","bundles/quiz/components/QuizCloseModal","bundles/quiz-common/actions/QuizActions","pages/open-course/common/models/itemMetadata","bundles/quiz-common/models/GradingAttempt","pages/open-course/item/views/verifiedCertificateBanner","bundles/quiz-common/utils/FsmUtils","i18n!nls/quiz","css!bundles/quiz/components/__styles__/Quiz"],function(require,exports,module){"use strict";function _defaults(e,s){for(var i=Object.getOwnPropertyNames(s),t=0;t<i.length;t++){var o=i[t],n=Object.getOwnPropertyDescriptor(s,o);n&&n.configurable&&void 0===e[o]&&Object.defineProperty(e,o,n)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var r=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])}return n},t,n,e=require("react"),a=require("bundles/phoenix/components/OrigamiRegion"),l=require("bundles/quiz/components/QuizBody"),i=require("bundles/quiz/components/QuizCloseModal"),s=require("bundles/quiz-common/actions/QuizActions"),u=s.showQuizStart,c=s.getQuizSession,p=require("pages/open-course/common/models/itemMetadata"),d=require("bundles/quiz-common/models/GradingAttempt"),m=require("pages/open-course/item/views/verifiedCertificateBanner"),f=require("bundles/quiz-common/utils/FsmUtils"),o=f.isState,g=require("i18n!nls/quiz");require("css!bundles/quiz/components/__styles__/Quiz");var y=(n=t=function(t){function Quiz(){var s,e,i;_classCallCheck(this,Quiz);for(var r=arguments.length,a=Array(r),n=0;r>n;n++)a[n]=arguments[n];return s=e=_possibleConstructorReturn(this,t.call.apply(t,[this].concat(a))),e.state={showCloseModal:!1},e.handleBeforeUnload=function(s){var t=e.props,i=t.attemptState,n=t.closingWillDiscardWorkMessage;if(o(i,"submitted"))return void 0;return(s||window.event).returnValue=n,n},e.handleStayOnPage=function(){e.closeModal()},e.handleConfirmClose=function(){e.closeModal(),e.context.executeAction(u)},e.handleClose=function(){var t=e.props.attemptState;o(t,"submitted")?e.handleConfirmClose():e.setState({showCloseModal:!0})},i=s,_possibleConstructorReturn(e,i)}return _inherits(Quiz,t),Quiz.prototype.componentDidMount=function componentDidMount(){var e=this.props.assessmentClient,t=this.context.executeAction;t(c,{client:e})},Quiz.prototype.componentWillUnmount=function componentWillUnmount(){window.removeEventListener("beforeunload",this.handleBeforeUnload)},Quiz.prototype.closeModal=function closeModal(){this.setState({showCloseModal:!1})},Quiz.prototype.render=function render(){var t=this.props,u=t.itemMetadata,n=t.sessionData,c=t.attemptState,p=t.closingWillDiscardWorkMessage,d=this.state.showCloseModal,s=n&&n.questions||[];return e.createElement("div",{className:"rc-Quiz"},o(c,"submitted")&&e.createElement(a,{ViewClass:m,viewOptions:{isItemPassable:!0,itemMetadata:u}}),s.length>0&&e.createElement(l,r({},this.props,{questions:s,onClose:this.handleClose})),d&&e.createElement(i,{message:p,onStayOnPage:this.handleStayOnPage,onConfirmClose:this.handleConfirmClose}))},Quiz}(e.Component),t.propTypes={itemMetadata:e.PropTypes.instanceOf(p).isRequired,attemptState:e.PropTypes.string.isRequired,courseMaterials:e.PropTypes.object.isRequired,verificationDisplay:e.PropTypes.object.isRequired,assessmentClient:e.PropTypes.object.isRequired,gradingAttempt:e.PropTypes.instanceOf(d),sessionId:e.PropTypes.string,sessionData:e.PropTypes.object,closingWillDiscardWorkMessage:e.PropTypes.string},t.contextTypes={executeAction:e.PropTypes.func.isRequired},t.defaultProps={closingWillDiscardWorkMessage:g("Closing will discard your work so far.")},n);module.exports=y});